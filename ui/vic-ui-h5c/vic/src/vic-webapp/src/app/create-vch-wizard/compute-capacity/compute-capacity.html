<p class="smaller-p-body-text">
  Select a cluster or resource pool to run this virtual container host. Advanced options are available to specify additional
  requirements.
</p>
<form [formGroup]="form" novalidate>
  <section class="form-block">
    <div class="form-group">
      <label class="p5">Cluster or resource pool <span class="red-text">*</span></label>
      <clr-tree-node id="compute-resource-selector" [clrTreeNodeExpandable]="true" [clrTreeNodeExpanded]="true" (clrTreeNodeExpandedChange)="loadClusters()"
        [clrTreeNodeLoading]="isTreeLoading" [class.invalid]="form.invalid && form.getError('invalidComputeResource')">
        <button class="clr-treenode-link">
          <clr-icon shape="building"></clr-icon>
          {{ datacenter.length ? datacenter[0]['text'] : '' }}
        </button>
        <clr-tree-node *ngFor="let cluster of clusters" [clrTreeNodeExpandable]="true" (clrTreeNodeExpandedChange)="loadResources(cluster.objRef)"
          [clrTreeNodeLoading]="isTreeLoading">
          <button (click)="selectComputeResource(cluster)" class="clr-treenode-link" [class.active]="selectedObjectName === cluster['text']">
            <clr-icon shape="cluster"></clr-icon>
            {{ cluster['text'] }}
          </button>
          <clr-tree-node *ngFor="let resource of resources">
            <button (click)="selectComputeResource(resource, cluster)" class="clr-treenode-link" [class.active]="selectedObjectName === resource['text']">
              <clr-icon shape="host"></clr-icon>
              {{ resource['text'] }}
            </button>
          </clr-tree-node>
        </clr-tree-node>
      </clr-tree-node>
    </div>
    <div>
      <div class="fg-group">
        <label class="p1">Virtual Container Host limits</label>
        <div class="form-group">
          <label class="p5" for="cpu-limit-selector">CPU</label>
          <label class="p5" for="cpu-limit-selector" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-lg tooltip-top-left"
            [class.invalid]="form.get('cpuLimit').invalid && (form.get('cpuLimit').dirty || form.get('cpuLimit').touched)">
          <input id="cpu-limit-selector" type="text" formControlName="cpuLimit">
          <span class="tooltip-content">{{ formErrMessage }}</span>
          <div class="maxResourceIndicator">Max: {{ resourceLimits.cpu.maxUsage || '-' }} MHz, Min: 1 MHz</div>
        </label>&nbsp;MHz
        </div>
        <div class="form-group">
          <label class="p5" for="memory-limit-selector">Memory</label>
          <label class="p5" for="memory-limit-selector" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-lg tooltip-top-left"
            [class.invalid]="form.get('memoryLimit').invalid && (form.get('memoryLimit').dirty || form.get('memoryLimit').touched)">
            <input id="memory-limit-selector" type="text" formControlName="memoryLimit">
            <span class="tooltip-content">{{ formErrMessage }}</span>
            <div class="maxResourceIndicator">Max: {{ resourceLimits.memory.maxUsage || '-' }} MB, Min: 1 MB</div>
          </label>&nbsp;MB
        </div>
      </div>
      <a id="advanced-toggle" class="btn btn-link" (click)="toggleAdvancedMode()">{{ inAdvancedMode ? 'Basic' : 'Advanced' }} <clr-icon [attr.shape]="inAdvancedMode ? 'caret up' : 'caret down'"></clr-icon></a>
      <div *ngIf="inAdvancedMode">
        <div class="form-group">
          <label class="p5" for="debug-level-selector">Debug</label>
          <div class="select">
            <select id="debug-level-selector" formControlName="debug">
            <option value="0">0 - Verbose logging is disabled</option>
            <option value="1">1 - Provides extra verbosity in the logs</option>
            <option value="2">2 - Exposes server on more interfaces, launches pprof in container VMs</option>
            <option value="3">3 - Disables recovery logic and logs sensitive data</option>
          </select>
          </div>
        </div>
        <div>
          <label class="p1">Virtual Container Host settings</label>
          <div class="form-group">
            <label class="p5" for="cpu-reservation-selector">CPU reservation</label>
            <label class="p5" for="cpu-reservation-selector" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-lg tooltip-top-left"
              [class.invalid]="form.get('cpuReservation').invalid && (form.get('cpuReservation').dirty || form.get('cpuReservation').touched)">
            <input id="cpu-reservation-selector" type="text" formControlName="cpuReservation">
            <span class="tooltip-content">{{ formErrMessage }}</span>
            <div class="maxResourceIndicator">Max: {{ resourceLimits.cpu.unreservedForPool || '-' }} MHz, Min: 1 MHz</div>
          </label>&nbsp;MHz
          </div>
          <div class="form-group">
            <label class="p5" for="cpu-shares-selector">CPU shares</label>
            <div class="select">
              <select id="cpu-shares-selector" formControlName="cpuShares">
              <option value="2000">Low</option>
              <option value="4000">Normal</option>
              <option value="8000">High</option>
            </select>
            </div>
          </div>
          <div class="form-group">
            <label class="p5" for="memory-reservation-selector">Memory reservation</label>
            <label class="p5" for="memory-reservation-selector" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-lg tooltip-top-left"
              [class.invalid]="form.get('memoryReservation').invalid && (form.get('memoryReservation').dirty || form.get('memoryReservation').touched)">
              <input id="memory-reservation-selector" type="text" formControlName="memoryReservation">
              <span class="tooltip-content">{{ formErrMessage }}</span>
              <div class="maxResourceIndicator">Max: {{ resourceLimits.memory.unreservedForPool || '-' }} MB, Min: 1 MB</div>
            </label>&nbsp;MB
          </div>
          <div class="form-group">
            <label class="p5" for="memory-shares-selector">Memory shares</label>
            <div class="select">
              <select id="memory-shares-selector" formControlName="memoryShares">
                <option value="81920">Low</option>
                <option value="163840">Normal</option>
                <option value="327680">High</option>
              </select>
            </div>
          </div>
        </div>
        <div class="fg-group">
          <label class="p1">VM endpoint settings</label>
          <div class="form-group">
            <label class="p5" for="vm-cpu-selector">CPUs</label>
            <label class="p5" for="vm-cpu-selector" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-lg tooltip-top-left"
              [class.invalid]="form.get('endpointCpu').invalid && (form.get('endpointCpu').dirty || form.get('endpointCpu').touched)">
              <input id="vm-cpu-selector" type="text" formControlName="endpointCpu">
              <span class="tooltip-content">{{ formErrMessage }}</span>
            </label>
          </div>
          <div class="form-group">
            <label class="p5" for="vm-memory-selector">Memory</label>
            <label class="p5" for="vm-memory-selector" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-lg tooltip-top-left"
              [class.invalid]="form.get('endpointMemory').invalid && (form.get('endpointMemory').dirty || form.get('endpointMemory').touched)">
              <input id="vm-memory-selector" type="text" formControlName="endpointMemory">
              <span class="tooltip-content">{{ formErrMessage }}</span>
              <div class="maxResourceIndicator">Max: {{ resourceLimits.memory.maxUsage || '-' }} MB, Min: 1 MB</div>
            </label>&nbsp;MB
          </div>
        </div>
      </div>
    </div>
  </section>
</form>
